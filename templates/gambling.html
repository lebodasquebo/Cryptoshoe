<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Cryptoshoe - Gambling</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/static/style.css?v=8">
  <link rel="stylesheet" href="/static/gambling.css">
</head>
<body>
  <div class="bg-grid"></div>
  <nav class="navbar">
    <div class="nav-inner">
      <a href="/" class="nav-logo">
        <span class="logo-icon">ğŸ‘Ÿ</span>
        <span class="logo-text">CRYPTO<span class="accent">SHOE</span></span>
      </a>
      <div class="nav-links">
        <a href="/" class="nav-link"><span class="nav-icon">ğŸ“ˆ</span><span class="nav-text">Market</span></a>
        <a href="/inventory" class="nav-link"><span class="nav-icon">ğŸ’</span><span class="nav-text">Inventory</span></a>
        <a href="/gambling" class="nav-link active"><span class="nav-icon">ğŸ°</span><span class="nav-text">Gambling</span></a>
        <a href="/appraise" class="nav-link"><span class="nav-icon">ğŸ”</span><span class="nav-text">Appraise</span></a>
        <a href="/users" class="nav-link"><span class="nav-icon">ğŸ¤</span><span class="nav-text">Trade</span></a>
        <a href="/chat" class="nav-link"><span class="nav-icon">ğŸ’¬</span><span class="nav-text">Chat</span></a>
        {% if is_admin %}
        <a href="/admin" class="nav-link nav-admin"><span class="nav-icon">ğŸ”</span><span class="nav-text">Admin</span></a>
        {% endif %}
      </div>
      <div class="nav-user">
        <div class="nav-bal">
          <div class="bal-label">BALANCE</div>
          <div class="bal-val">$<span id="bal">0.00</span></div>
        </div>
        <a href="/logout" class="nav-logout" title="Logout">ğŸšª</a>
      </div>
    </div>
  </nav>

  <div id="announcement-bar" class="announcement-bar"></div>

  <main class="gambling-main">
    <div class="gambling-tabs">
      <button class="tab-btn active" data-tab="pot">ğŸ° Shoe Pot</button>
      <button class="tab-btn" data-tab="lootbox">ğŸ Lootboxes</button>
    </div>

    <!-- SHOE POT SECTION -->
    <section id="pot-section" class="gambling-section">
      <div class="pot-container">
        <div class="pot-header">
          <h2>ğŸ° SHOE POT</h2>
          <div class="pot-timer">
            <span class="timer-label">Spins in:</span>
            <span class="timer-value" id="pot-timer">0:00</span>
          </div>
          <div class="pot-cap">Cap: <span id="pot-cap">$0</span></div>
        </div>
        
        <div class="pot-progress">
          <div class="pot-bar">
            <div class="pot-fill" id="pot-fill"></div>
          </div>
          <div class="pot-stats">
            <span>Total: $<span id="pot-total">0</span></span>
            <span><span id="pot-percent">0</span>% filled</span>
          </div>
        </div>

        <div class="pot-body">
          <div class="pot-wheel">
            <div class="wheel-container" id="wheel-container">
              <div class="wheel-empty">No entries yet</div>
            </div>
            <div class="wheel-pointer">â–¼</div>
          </div>

          <div class="pot-entries">
            <h3>Participants</h3>
            <div id="participants-list" class="participants-list"></div>
          </div>
        </div>

        <div class="pot-actions">
          <button id="enter-pot-btn" class="enter-btn">+ Enter Shoe</button>
          {% if is_admin %}
          <button id="spin-btn" class="spin-btn">ğŸ² Force Spin</button>
          {% endif %}
        </div>

        <div class="pot-history">
          <h3>Recent Winners</h3>
          <div id="pot-history" class="history-list"></div>
        </div>
      </div>

      <!-- Enter Modal -->
      <div id="enter-modal" class="modal hidden">
        <div class="modal-content">
          <button class="modal-close" id="modal-close">&times;</button>
          <h2>Enter Shoes into Pot</h2>
          <p class="modal-hint">Click shoes to select/deselect. Use Â±buttons for qty.</p>
          <div class="shoe-select">
            <h4>Your Shoes</h4>
            <div id="your-shoes" class="shoe-grid"></div>
          </div>
          <div class="selected-shoe">
            <span>Selected: </span><span id="selected-name">None</span>
            <span class="selected-value">Value: $<span id="selected-value">0</span></span>
          </div>
          <div class="modal-actions">
            <button id="confirm-enter" class="confirm-btn" disabled>Enter Selected into Pot</button>
            <button id="add-all-btn" class="add-all-btn">ğŸš€ Add All Shoes</button>
          </div>
        </div>
      </div>
    </section>

    <!-- LOOTBOX SECTION -->
    <section id="lootbox-section" class="gambling-section hidden">
      <div class="lootbox-container">
        <h2>ğŸ LOOTBOXES</h2>
        <p class="lootbox-desc">Pay $2.5k-$150k for a pre-appraised shoe. Same odds as appraisals â€” value ranges from -50% to +45% of your bet. No busts!</p>
        
        <div class="lootbox-body">
          <div class="lootbox-controls">
            <div class="preset-grid">
              <button class="preset-btn" data-amt="2500">$2.5K</button>
              <button class="preset-btn" data-amt="10000">$10K</button>
              <button class="preset-btn" data-amt="25000">$25K</button>
              <button class="preset-btn" data-amt="50000">$50K</button>
              <button class="preset-btn" data-amt="100000">$100K</button>
              <button class="preset-btn" data-amt="150000">$150K</button>
            </div>
            <div class="custom-amount">
              <label>Custom Amount</label>
              <input type="number" id="loot-amount" min="2500" max="150000" value="10000">
            </div>
            <button id="open-loot-btn" class="open-btn">ğŸ Open Lootbox</button>
          </div>
          
          <div class="lootbox-result">
            <div id="loot-idle" class="loot-state">
              <div class="loot-box">ğŸ‘€</div>
              <p>Select an amount and open a lootbox!</p>
            </div>
            <div id="loot-opening" class="loot-state hidden">
              <div class="loot-box spinning">ğŸ‘€</div>
              <p>Opening...</p>
            </div>
            <div id="loot-result" class="loot-state hidden">
              <div class="result-shoe">
                <div id="result-rarity" class="result-rarity"></div>
                <div id="result-name" class="result-name"></div>
                <div id="result-rating" class="result-rating"></div>
              </div>
              <div class="result-stats">
                <div><span>Paid:</span><span id="result-paid">$0</span></div>
                <div><span>Market:</span><span id="result-price">$0</span></div>
                <div><span>Value:</span><span id="result-value">$0</span></div>
              </div>
              <div id="result-verdict" class="result-verdict"></div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <div id="toast" class="toast"></div>
  
  <script>window.IS_ADMIN = {{ 'true' if is_admin else 'false' }};</script>
  <script src="/static/ban-check.js?v=1"></script>
  <script src="/static/gambling.js?v={{ range(10000) | random }}"></script>
</body>
</html>
